
import { PersonalityAnalysis } from "./types";
import { format } from "date-fns";

/**
 * Formats an analysis for download
 */
export const formatAnalysisForDownload = (analysis: PersonalityAnalysis) => {
  return {
    overview: analysis.overview,
    traits: analysis.traits.map(trait => ({
      trait: trait.trait,
      score: trait.score,
      description: trait.description,
      strengths: trait.strengths,
      challenges: trait.challenges,
      growthSuggestions: trait.growthSuggestions
    })),
    intelligence: {
      type: analysis.intelligence.type,
      score: analysis.intelligence.score,
      description: analysis.intelligence.description,
      domains: analysis.intelligence.domains
    },
    cognitiveStyle: analysis.cognitiveStyle,
    valueSystem: analysis.valueSystem,
    motivators: analysis.motivators,
    inhibitors: analysis.inhibitors,
    weaknesses: analysis.weaknesses,
    growthAreas: analysis.growthAreas,
    relationshipPatterns: analysis.relationshipPatterns,
    careerSuggestions: analysis.careerSuggestions,
    scores: {
      intelligence: analysis.intelligenceScore,
      emotionalIntelligence: analysis.emotionalIntelligenceScore
    },
    roadmap: analysis.roadmap,
    learningPathways: analysis.learningPathways,
    generatedAt: format(new Date(analysis.createdAt), 'PPP')
  };
};

/**
 * Generates a PDF report
 * This is a placeholder - in a real app, you would use a library like jsPDF
 */
export const generatePdfReport = (analysis: PersonalityAnalysis): string => {
  // This is a placeholder function
  // In a real implementation, you would use a PDF generation library
  
  // For now, we'll return a dummy data URL
  return `data:application/pdf;base64,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`;
};

/**
 * Downloads a report in the specified format
 */
export const downloadReport = (analysis: PersonalityAnalysis, format: 'json' | 'pdf' = 'json') => {
  if (!analysis) {
    throw new Error("No analysis data to download");
  }
  
  try {
    if (format === 'json') {
      // Format the analysis data
      const formattedAnalysis = formatAnalysisForDownload(analysis);
      
      // Convert to JSON string
      const jsonStr = JSON.stringify(formattedAnalysis, null, 2);
      
      // Create a Blob with the JSON data
      const blob = new Blob([jsonStr], { type: 'application/json' });
      
      // Create a temporary download link
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `personality-analysis-${format(new Date(), 'yyyy-MM-dd')}.json`;
      
      // Trigger the download
      document.body.appendChild(a);
      a.click();
      
      // Clean up
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      return true;
    } else if (format === 'pdf') {
      // In a real implementation, you would generate a PDF file
      // For now, we'll use a mock function
      const pdfDataUrl = generatePdfReport(analysis);
      
      // Create a temporary download link
      const a = document.createElement('a');
      a.href = pdfDataUrl;
      a.download = `personality-analysis-${format(new Date(), 'yyyy-MM-dd')}.pdf`;
      
      // Trigger the download
      document.body.appendChild(a);
      a.click();
      
      // Clean up
      document.body.removeChild(a);
      
      return true;
    }
    
    return false;
  } catch (error) {
    console.error("Error downloading report:", error);
    throw error;
  }
};
